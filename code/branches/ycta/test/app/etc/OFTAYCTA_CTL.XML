<?xml version='1.0' encoding='ISO-8859-1'?>
<Application name="EFEA" code="445">
  <!--电力电费业务本地主控-->
  <!--ConfigDeclare>
    <Config name="BatFormat"   value="etc/EFEA_FMT_441999.XML"/>
    <Config name="ParaFile"    value="etc/CFG_EFEA_441999.XML"/>
    <Config name="OPFCSW"      value="etc/EFEA_CSW2.XML"/>
  </ConfigDeclare-->
  <!--BusDefDeclare>
  	<Busdef name="BrNo"      value="441999"/>
    <Busdef name="AplCls"    value="202"/>
  </BusDefDeclare-->
  <PackageDeclare>
    <Package name="AFE"        value="etc/DAFE_PKG.XML"/>
  </PackageDeclare>
  <TableDeclare>
    <Table name="afetxnjnl"    value="afetxnjnl"/>  <!--业务流水表-->
    <Table name="afebatrec"    value="afebatrec"/>  <!--批量扩展表-->
    <!--Table name="efeaclrtbl"   value="efeaclrtbl"/-->  <!--广州电力清算日期表-->
    <!--Table name="efeaclrlog"   value="efeaclrlog"/-->  <!--广州电力清算参数修改记录表-->
    <!--Table name="efeaclrdtl"   value="efeaclrdtl"/-->  <!--广州电力清算明细表表-->
  </TableDeclare>
  <GlobalFunction>
    <Include file="etc/ActJudge_IIT.XML"/>     <!--区别对公对私帐号-->
    <!--add by xuan_20101108-->
    <Function name="_after">
        <Process>
           <If condition="ISNULL($MsgTyp)">
              <If condition="ISNULL(DELBOTHSPACE($RspCod))"> <!--若RspCod为空，则认为成功-->
                 <Set>MsgTyp=N</Set>
                 <Set>RspCod=000000</Set>
              </If>
              <Else>
                 <If condition="IS_NOEQUAL_STRING($RspCod,000000)"> <!--返回码不为000000-->
                    <Set>MsgTyp=E</Set>
                 </If>
                 <Else>
                    <Set>MsgTyp=N</Set>
                 </Else>
              </Else>
           </If>
        </Process>
    </Function>
    <!--end by xuan_20101108-->
  </GlobalFunction>
  <Define>
    <!--检查交易来源-->
    <!--Macro name="Chk_TxnSrc">
      <If condition="INTCMP(STRLEN(DELBOTHSPACE($TxnSrc)),3,0)">
        <Set>TxnCnl=TRM</Set>
        <Set>CnlTyp=0</Set>
      </If>
      <Else>
        <Set>TxnSrc=DELBOTHSPACE($TxnSrc)</Set>
        <Exec func="PUB:CodeSwitching">
          <Arg name="DatSrc"  value="OPFCSW"/>
          <Arg name="SourNam" value="TxnSrc"/>
          <Arg name="DestNam" value="CnlTyp"/>
          <Arg name="TblNam"  value="TxnSrc2CnlTyp"/>
        </Exec>
      </Else>
    </Macro>

    <Macro name="TxnSrc_TxnCnl">
      <Set>TxnSrc=DELBOTHSPACE($TxnSrc)</Set>
      <Exec func="PUB:CodeSwitching">
        <Arg name="DatSrc"  value="OPFCSW"/>
        <Arg name="SourNam" value="TxnSrc"/>
        <Arg name="DestNam" value="TxnCnl"/>
        <Arg name="TblNam"  value="TxnSrc2TxnCnl"/>
      </Exec>
    </Macro-->

  </Define> 

  <Transaction code="484501" desc="终端签到认证1">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484501"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=签到失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484502" desc="终端签到认证2">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484502"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=签到失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484503" desc="共用交易查询P_TRAN_QRY">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484503"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=共用交易查询失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484504" desc="CPU圈存查询通讯接口P_CPU_LOAD_QRY">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484504"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=CPU圈存查询失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

//TODO
  <Transaction code="484505" desc="CPU圈存通讯接口P_CPU_LOAD">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484505"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=CPU圈存失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

//TODO
  <Transaction code="484506" desc="CPU圈存提交通讯接口P_CPU_LOAD_SUBMIT">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484506"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=CPU圈存提交失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484511" desc="M1圈存查询通讯接口P_M1_LOAD_QRY">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484511"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=M1圈存查询失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484512" desc="M1圈存通讯接口P_M1_LOAD">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484512"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=M1圈存查询失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484513" desc="M1冲正通讯接口P_M1_ROLLBACK">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484513"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=M1冲正失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484510" desc="CPU卡同步">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484510"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=CPU卡同步失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484516" desc="终端监控P_MONITOR">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484516"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=终端监控失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484517" desc="监控配置P_SET_MONITOR">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484517"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=监控配置失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484518" desc="转移卡查询P_TRANSFOR_QRY">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484518"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=转移卡查询失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484519" desc="转移确认查询P_TRANSFOR_COMFIRM_QRY">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484519"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=转移确认查询失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484520" desc="转移消费P_TRANSFOR_PURCHASE">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484520"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=转移消费失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484521" desc="转出消费P_TRANSFOR_PURCHASE_SUBMIT">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484521"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=转出消费失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484522" desc="卡片激活">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484522"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=卡片激活失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484523" desc="捕获黑名单P_SET_BLACKLIST">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484523"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=捕获黑名单失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

  <Transaction code="484524" desc="黑名单提交P_BLACKLIST_SUBMIT">
    <FlowCtrl>
      <Exec func="PUB:InitTransaction"/>
      
      <Exec func="PUB:CallThirdOther">
        <Arg name="HTxnCd" value="484524"/>
        <Arg name="ObjSvr" value="STDAYCTA"/>
      </Exec>
      <If condition="$RspCod!=000000">
        <Set>RspCod=YCT999</Set>
        <Set>MsgTyp=E</Set>
        <Set>RspMsg=黑名单提交失败!</Set>
        <Return/>
      </If>

    </FlowCtrl>
  </Transaction>

</Application>