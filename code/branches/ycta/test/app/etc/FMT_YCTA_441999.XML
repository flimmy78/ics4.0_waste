<?xml version='1.0' encoding='ISO-8859-1'?>
<BATCH debug_file="agtfmta.log" err_file="agtfmta.err">

  <!--CodeSwitching>
    <Table name="H2T_EFE_441"  file="etc/EFEA_CSW2.XML">
      <Column name="HRspCd" sort="no"/>
      <Column name="TRspCd" sort="no"/>
    </Table>
  </CodeSwitching-->

  <Process name="YCTA_Dtl"   desc="羊城通交易明细">
    <Data>
      <Item name="TERMID"  length="13" />   <!-- 供电公司系统参考号 -->
      <!--Item name="Flag" length="1" value="	" /-->
      <Item name="SYS_SEQ" length="17"  />   <!-- 供电公司用户编号 -->
      <Item name="ICN"     length="17"  />   <!-- 供电公司清算日期 -->
      <Item name="TIM"     length="15"  />   <!-- 银行交易日期 -->
      <Item name="TF"      length="9"   /> <!-- 银行交易时间 -->
      <Item name="BAL"     length="9"   /> <!-- 银行交易流水号 -->
      <Item name="TT"      length="2"   /> <!--客户帐号-->
    </Data>
  </Process>    



  <Process name="EFEA_CAIWU" desc="交行电子对账文件格式">   
    <Data>
      <Item    name="ActDat"  length="10"  />   <!-- 入帐日期 -->
      <Item    name="Flag"    length="1"  value=" "/>      
      <If condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460230), IS_EQUAL_STRING(TxnCnl,THD))">
         <Item    name="CWTxnCod"  length="10"  value="9026" />   <!-- 实时扣款交易代码 -->
         <Item    name="Flag"      length="1"   value=" "/>          
      </If>
      <ElseIf condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460245), ,IS_EQUAL_STRING(TxnCnl,TRM)">
         <If condition="IS_EQUAL_STRING(SUBSTR($RsFld1,44,2),10)">
            <Item    name="CWTxnCod"  length="10"  value="9018" />   <!-- 柜台现金交易代码 -->
            <Item    name="Flag"      length="1"   value=" "/>          
         </If>
         <Else>
            <Item    name="CWTxnCod"  length="10"  value="60003" />   <!-- 柜台支票交易代码 -->
            <Item    name="Flag"      length="1"   value=" "/>
         </Else>
      </ElseIf>
      <ElseIf condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460200), ,IS_EQUAL_STRING(TxnCnl,THD)">
         <Item    name="CWTxnCod"  length="10"  value="9018" />   <!-- 交行批量文件代收交易代码 -->
         <Item    name="Flag"      length="1"   value=" "/>          
      </ElseIf>
      <ElseIf condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460245), ,IS_NOEQUAL_STRING(TxnCnl,TRM)">
         <Item    name="CWTxnCod"  length="10"  value="8888" />   <!-- 交行网上支付交易代码 -->
         <Item    name="Flag"      length="1"   value=" "/>          
      </ElseIf>
      <Item    name="VchTyp"  length="3"  value=" "/>   <!-- 凭证种类 -->
      <Item    name="Flag"    length="1"  value=" "/>  
      <Item    name="VchNo"   length="9"  value=" "/>   <!-- 凭证号 -->
      <Item    name="Flag"    length="1"  value=" "/>  
      <If condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460230), IS_EQUAL_STRING(TxnCnl,THD))">
         <Item    name="Summary"   length="20"  value="电费504520001" />   <!-- 实时扣款摘要 -->
         <Item    name="Flag"      length="1"   value=" "/>          
      </If>
      <ElseIf condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460245), ,IS_EQUAL_STRING(TxnCnl,TRM)">
         <If condition="IS_EQUAL_STRING(SUBSTR($RsFld1,44,2),10)">
            <Item    name="Summary"   length="20"  value="电费504510001" />   <!-- 柜台现金摘要 -->
            <Item    name="Flag"      length="1"   value=" "/>          
         </If>
         <Else>
            <Item    name="Summary"   length="20"  expression="STRCAT(电费,SUBSTR($RsFld1,46,8))" />   <!-- 电费+支票号摘要 -->
            <Item    name="Flag"      length="1"   value=" "/>
         </Else>
      </ElseIf>
      <ElseIf condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460200), ,IS_EQUAL_STRING(TxnCnl,THD)">
         <Item    name="Summary"   length="20"  value="电费504001001" />   <!-- 交行批量文件代收摘要 -->
         <Item    name="Flag"      length="1"   value=" "/>          
      </ElseIf>
      <ElseIf condition="AND(IS_EQUAL_STRING(DELBOTHSPACE($TxnCod),460245), ,IS_NOEQUAL_STRING(TxnCnl,TRM)">
         <Item    name="Summary"   length="20"  value="网银" />   <!-- 网银摘要 -->
         <Item    name="Flag"      length="1"   value=" "/>          
      </ElseIf>      
      <Item    name="CDFlag"  length="1"  value="0"/>   <!-- 借贷标志 -->
      <Item    name="Flag"    length="1"  value=" "/>        
      <Item    name="TxnAmt"  length="1"  />            <!-- 发生额 -->
      <Item    name="Flag"    length="1"  value=" "/>        
      <Item    name="OrgNo"   length="1"  />            <!-- 网点号 -->
      <Item    name="Flag"    length="1"  value=" "/>          
      <Item    name="TlrId"  length="1"  />             <!-- 柜员号 -->
      <Item    name="Flag"    length="1"  value=" "/>                                
    </Data>
  </Process> 
  
</BATCH>
