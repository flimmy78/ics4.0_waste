<?xml version='1.0' encoding='ISO-8859-1'?>
<Application name="CAD" pre_dll="dll/pre_term.so" pre_func="pre_term" spe_dll="dll/pre_term.so" spe_func="spe_term" server="OFRTCAD1" trace="no">
  <CodeSwitching>
    <Table name="StsChn" file="etc/CAD_CSW.XML">
      <Column name="RecSts" sort="no"/>
      <Column name="StsChn" sort="no"/>
    </Table>
    <Table name="WayChn" file="etc/CAD_CSW.XML">
      <Column name="CrgWay" sort="no"/>
      <Column name="WayChn" sort="no"/>
    </Table>
    <Table name="Month" file="etc/CAD_CSW.XML">
      <Column name="Month" sort="no"/>
      <Column name="MthIdx" sort="no"/>
    </Table>
  </CodeSwitching>
  <Define>
    <!-- 现金缴款记账请求 -->
    <Macro name="cad_request01">
      <Item name="RcpTyp"   length="1"/>
      <Item name="RcpNo"   	length="15"/>
      <Item name="CcyCod"   length="3"/>
      <Item name="CusNam" 	length="60"/>
      <Item name="BilSqn" 	length="12"/>
      <Item name="CshNo" 	length="3"/>
      <Item name="CrgCod1" 	length="10" expression="DELBOTHSPACE($CrgCod1)"/>
      <Item name="CrgUni1"  length="6"/>
      <Item name="UniPri1" 	length="12"/>
      <Item name="UniNum1" 	length="6"/>
      <Item name="ItmAmt1" 	length="12"/>
      <Item name="CrgItm1" 	length="60"/>
      <Item name="CrgCod2" 	length="10" expression="DELBOTHSPACE($CrgCod2)"/>
      <Item name="CrgUni2"  length="6"/>
      <Item name="UniPri2" 	length="12"/>
      <Item name="UniNum2" 	length="6"/>
      <Item name="ItmAmt2" 	length="12"/>
      <Item name="CrgItm2" 	length="60"/>
      <Item name="CrgCod3" 	length="10" expression="DELBOTHSPACE($CrgCod3)"/>
      <Item name="CrgUni3"  length="6"/>
      <Item name="UniPri3" 	length="12"/>
      <Item name="UniNum3" 	length="6"/>
      <Item name="ItmAmt3" 	length="12"/>
      <Item name="CrgItm3" 	length="60"/>
      <Item name="TxnAmt" 	length="15"/>
      <Item name="CrgDpt" 	length="60"/>
    </Macro>
    <!-- 转账请求 -->
    <Macro name="cad_request02">
      <Item name="TckNo" 	length="11"/>
      <Item name="VchSeq" 	length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
      <Item name="STotAmt" 	length="15"/>
      <Item name="SpsAmt" 	length="15"/>
      <Item name="RcpTyp"   length="1"/>
      <Item name="RcpNo"   	length="15"/>
      <Item name="CcyCod"   length="3"/>
      <Item name="CusNam" 	length="60"/>
      <Item name="BilSqn" 	length="12"/>
      <Item name="CrgCod1" 	length="10" expression="DELBOTHSPACE($CrgCod1)"/>
      <Item name="CrgUni1"  length="6"/>
      <Item name="UniPri1" 	length="12"/>
      <Item name="UniNum1" 	length="6"/>
      <Item name="ItmAmt1" 	length="12"/>
      <Item name="CrgItm1" 	length="60"/>
      <Item name="CrgCod2" 	length="10" expression="DELBOTHSPACE($CrgCod2)"/>
      <Item name="CrgUni2"  length="6"/>
      <Item name="UniPri2" 	length="12"/>
      <Item name="UniNum2" 	length="6"/>
      <Item name="ItmAmt2" 	length="12"/>
      <Item name="CrgItm2" 	length="60"/>
      <Item name="CrgCod3" 	length="10" expression="DELBOTHSPACE($CrgCod3)"/>
      <Item name="CrgUni3"  length="6"/>
      <Item name="UniPri3" 	length="12"/>
      <Item name="UniNum3" 	length="6"/>
      <Item name="ItmAmt3" 	length="12"/>
      <Item name="CrgItm3" 	length="60"/>
      <Item name="TxnAmt" 	length="15"/>
      <Item name="CrgDpt" 	length="60"/>
    </Macro>
    <!-- 现金缴款记账响应 -->
    <Macro name="cad_response01">
      <Item name="RcpTyp" length="1"/>
      <Item name="RcpNo"  length="15"/>
      <Item name="TckNo"  length="11"/>
      <Item name="ActDat" length="8"/>
      <Item name="CusNam" length="50"/>
      <Item name="BilAmt" length="15"  expression="AMTSIMPLEFMT($BilAmt)"/>
      <Item name="BilSqn" length="12"/>
      <SwitchCode name="CrgWay" new_name="WayChn"  tab_name="WayChn"  col_name="CrgWay"/>		
      <Item name="WayChn" length="4"/>  
      <Item name="CrgDpt" length="60"/>
      <Item name="CapAmt" length="60" expression="DELSPACE($CapAmt,left)" align_mode="right"/>
      <Item name="Smr" value="广东省行政事业性收费统一票据" necessary="no" length="28"/>
      <Group name="ROOT" repeat_name="RecNum">
        <Item name="CrpCod" length="5"  desc="执收单位代码"/>
        <Item name="ItmCod" length="2"  desc="项目代码"/>
        <If condition="OR(INTCMP($RcpTyp,3,1),INTCMP($RcpTyp,3,4))">
          <If condition="INTCMP(STRLEN($CrgItm),2,24)">
            <Item name="CrgItm" length="32" expression="STRCAT(      ,DELBOTHSPACE($CrgItm))" desc="项目名称"/>
          </If>
         <Else>
            <Item name="CrgItm" length="32" expression="SUBSTR($CrgItm,1,32)" desc="项目名称"/>
          </Else>
        </If>
        <Else>
          <Item name="CrgItm" length="32" expression="SUBSTR($CrgItm,1,32)" desc="项目名称"/>
        </Else>
        <Item name="CrgUni" length="6"  desc="计费单位"/>
        <If condition="INTCMP($UniNum,3,0)">
          <Item name="Space" length="6"  value=" " desc="数量"/>
        </If>
        <Else>
          <Item name="UniNum" length="6"  expression="AMTDELZERO($UniNum)"  desc="数量"/>
        </Else>
        <If condition="INTCMP($UniPri,3,0)">
          <Item name="Space" length="8"  value=" " desc="收缴标准"/>
        </If>
        <Else>
          <Item name="UniPri" length="8"  expression="AMTSIMPLEFMT($UniPri)" desc="收缴标准"/>
        </Else>
        <Item name="ItmAmt" length="12" expression="AMTSIMPLEFMT($ItmAmt)" desc="收缴金额"/>
      </Group>
      <If condition="INTCMP($RecNum,3,1)=1">
         <Item name="ItmDat" length="146"/>
      </If>
      <ElseIf condition="INTCMP($RecNum,3,2)=1">
         <Item name="ItmDat" length="73"/>
      </ElseIf>
    </Macro>
    <!-- 行政收费明细查询请求 -->
    <Macro name="cad_request32">
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="TckNo"  length="11"/>
      </Else>
    </Macro>
    <!-- 行政收费明细查询响应 -->
    <Macro name="cad_response32">
      <If condition="IS_EQUAL_STRING($MsgTyp,N)">
        <PackItem name="TmpDat">
          <Item name="ApCode1"    length="2" value="46"/>
          <Item name="OFmtCd1"    length="3" value="X01"/>
      <Item name="RcpTyp"   length="1"/>
      <Item name="RcpNo"   	length="15"/>
      <Item name="CcyCod"   length="3"/>
      <Item name="CusNam" 	length="60"/>
      <Item name="BilSqn" 	length="12"/>
      <Item name="CrgCod1" 	length="10"/>
      <Item name="CrgUni1"  length="6"/>
      <Item name="UniPri1" 	length="12"/>
      <Item name="UniNum1" 	length="6"/>
      <Item name="ItmAmt1" 	length="12"/>
      <Item name="CrgItm1" 	length="60"/>
      <Item name="CrgCod2" 	length="10"/>
      <Item name="CrgUni2"  length="6"/>
      <Item name="UniPri2" 	length="12"/>
      <Item name="UniNum2" 	length="6"/>
      <Item name="ItmAmt2" 	length="12"/>
      <Item name="CrgItm2" 	length="60"/>
      <Item name="CrgCod3" 	length="10"/>
      <Item name="CrgUni3"  length="6"/>
      <Item name="UniPri3" 	length="12"/>
      <Item name="UniNum3" 	length="6"/>
      <Item name="ItmAmt3" 	length="12"/>
      <Item name="CrgItm3" 	length="60"/>
      <Item name="TxnAmt" 	length="12"/>
      <Item name="CrgDpt" 	length="60"/>
        </PackItem>
        <Item name="TmpDat" head_len="4" include_len="yes"/>
      </If>
      <Else>
        <Item name="BillText" deli_asc="-1"/>
      </Else>
    </Macro>
  </Define>

  <!--现金缴款记账-->
  <Transaction code="463801" service="463801" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Quote name="cad_request01"/>
      <AddItem name="AplSub" value="001"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N"> 
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="H68"/>
            <Quote name="cad_response01"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--现金缴款记账嵌套-->
  <Transaction code="463821" service="463821" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgCod" 	length="10"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
       <Switch expression="$MsgTyp">
         <Case value="N">
           <PackItem name="TmpDat">
	         <Item name="ApCode" length="2" value="46"/>
      	     <Item name="OFmtCd" length="3" value="D00"/>
             <Item name="CrgDpt" length="60"/>
             <Item name="CrgItm" length="60"/>
           </PackItem>
           <Item name="TmpDat" head_len="4" include_len="yes"/>
           <Break/>
         </Case>
         <Case value="E">
           <PackItem name="TmpDat">
             <Item name="ApCode1" length="2" value="SC"/>
             <Item name="OFmtCd1" length="3" value="D04"/>
             <Item name="RspCod" length="6"/>
             <Item name="InPos"  value="0001"/>
             <Item name="RspMsg" length="56"/>
           </PackItem>
           <Item name="TmpDat" head_len="4" include_len="yes"/>
           <Break/>
         </Case>
         <Case value="A">
           <Item name="BillText" deli_asc="-1" />
           <Break/>
         </Case>
       </Switch>
    </Response>
  </Transaction>
  
  <!--金额乘法嵌套-->
  <Transaction code="463822" service="463822" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="UniPri" 	length="12"/>
      <Item name="UniNum" 	length="6"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
       <Switch expression="$MsgTyp">
         <Case value="N">
           <PackItem name="TmpDat">
	         <Item name="ApCode" length="2" value="46"/>
        	 <Item name="OFmtCd" length="3" value="D00"/>
             <Item name="ItmAmt" length="12" expression="ADDCHAR($ItmAmt,12,0,1)"/>
           </PackItem>
           <Item name="TmpDat" head_len="4" include_len="yes"/>
           <Break/>
         </Case>
         <Case value="E">
           <PackItem name="TmpDat">
             <Item name="ApCode1" length="2" value="SC"/>
             <Item name="OFmtCd1" length="3" value="D04"/>
             <Item name="RspCod" length="6"/>
             <Item name="InPos"  value="0001"/>
             <Item name="RspMsg" length="56"/>
           </PackItem>
           <Item name="TmpDat" head_len="4" include_len="yes"/>
           <Break/>
         </Case>
         <Case value="A">
           <Item name="BillText" deli_asc="-1" />
           <Break/>
         </Case>
       </Switch>
    </Response>
  </Transaction>

  <!-- 转账上主机查询交易 -->
  <Transaction service="463824" code="463824" log_switch="0">
     <Request delimiter_type="fixed">
       <Include file="etc/TRMTIA_IIT.XML"/>
       <Item name="CrgWay"  length="1"/>
       <Item name="TckNo"   length="11"/>
       <Item name="VchSeq"  length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
       <AddItem name="AplSub" value="002"/>
     </Request>
     <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="46"/>
      	    <Item name="OFmtCd1" length="3" value="D00"/>
            <Item name="TxnAmt" length="15" expression="ADDCHAR($TxnAmt,15,0,1)"/>
            <Item name="SpsAmt" length="15" expression="ADDCHAR($SpsAmt,15,0,1)"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>      
    </Response>
  </Transaction>

  <!--转账-->
  <Transaction code="463802" service="463802" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>   
      <Item name="CrgWay"  length="1"/>
      <Quote name="cad_request02"/>
    </Request>
    <Response necessary="no">
      <AddItem name="SAplCd" value="46"/>
      <AddItem name="STxnCd" value="3841"/>
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="H66"/>
            <Quote name="cad_response01"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <If condition="INTCMP($SpsAmt,6,0)">
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46" />
              <Item name="OFmtCd1"  length="3" value="X01" />
              <Item name="CrgWay"  length="1"/>
	          <Item name="TckNo"   length="11"/>
              <Item name="VchSeq"  length="2" expression="AMTDELZERO($VchSeq)"/>
              <Item name="STotAmt" length="15" expression="ADDCHAR($STotAmt,15,0,1)"/>
              <Item name="SpsAmt"  length="15" expression="ADDCHAR($SpsAmt,15,0,1)"/>
            </PackItem>
          </If>
          <Else>
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46"/>
              <Item name="OFmtCd1"  length="3" value="K81"/>
              <Item name="RspMsg"  length="60" value="交易成功"/>
            </PackItem>
          </Else>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--转账-->
  <Transaction code="463841" service="463802" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgWay"  length="1"/>
      <Quote name="cad_request02"/>
    </Request>
    <Response necessary="no">
      <AddItem name="SAplCd" value="46"/>
      <AddItem name="STxnCd" value="3841"/>
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="H66"/>
            <Quote name="cad_response01"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <If condition="INTCMP($SpsAmt,6,0)">
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46" />
              <Item name="OFmtCd1"  length="3" value="X01" />
              <Item name="CrgWay"  length="1"/>
	          <Item name="TckNo"   length="11"/>
              <Item name="VchSeq"  length="2" expression="AMTDELZERO($VchSeq)"/>
              <Item name="STotAmt" length="15" expression="ADDCHAR($STotAmt,15,0,1)"/>
              <Item name="SpsAmt"  length="15" expression="ADDCHAR($SpsAmt,15,0,1)"/>
            </PackItem>
          </If>
          <Else>
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46"/>
              <Item name="OFmtCd1"  length="3" value="K81"/>
              <Item name="RspMsg"  length="60" value="交易成功"/>
            </PackItem>
          </Else>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--轧账-->
  <Transaction code="463804" service="463804" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="PrtDat" 	length="8"/>
      <Item name="CTotAmt" 	length="15"/>
      <AddItem name="Month" length="2" expression="SUBSTR($PrtDat,5,2)"/>
      <SwitchCode name="Month" tab_name="Month" col_name="Month"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>
  
  <!-- 行政收费流水查询 -->
  <Transaction code="463805" service="463805" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="QActDat"  length="8"/>
        <Item name="QNodNo"   length="6"/>
        <Item name="QTlrId"   length="7"/>
        <Item name="QTckNo"   length="11"/>
        <Item name="QTxnAmt"  length="15"/>
        <Item name="QCrgCod"  length="10"/>
        <Item name="QRcpNo"   length="15"/>
        <Item name="QCusNam"  length="60"/>
        <Item name="QRecSts"  length="1"/>
      </Else>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
        <PackItem name="TmpDat">
          <Item name="ApCode1"    length="2" value="46"/>
          <Item name="OFmtCd1"  length="3"   value="Z01"/>
          <Item name="PagNo"   length="4"   value="0001"/>
          <Item name="VarSize" length="1"   value="3"/>
          <Item name="Ttl"     head_len="3" value="  行政收费流水查询  "/>
          <Item name="SubTtl"  head_len="3" value=" 流 水 号   小 序 号   金 额  收据编号  状态   缴 款 人 抹账方式"/>
          <Group name="Rec" repeat_name="RecNum"> 
            <PackItem name="TmpNam">                      	
              <Item name="TckNo"     length="11"/>      
              <Item name="VchSeq"    length="2" expression="AMTDELZERO($VchSeq)"/>
              <Item name="QryDat"    length="8"/>    							
		      <SwitchCode name="RecSts" new_name="StsChn"  tab_name="StsChn"  col_name="RecSts"/>
		      <Item name="StsChn"    length="4"/> 
              <Item name="RcpNo"     length="15"/> 
 		      <SwitchCode name="CrgWay" new_name="WayChn"  tab_name="WayChn"  col_name="CrgWay"/>		
 		      <Item name="WayChn"    length="4"/>  
		      <Item name="CrgCod"    length="10"/> 
		      <Item name="ItmAmt"    length="12"/> 
		      <Item name="NodNo"     length="6"/>  	
	      	  <Item name="TlrId"     length="7"/>  
 		      <Item name="CusNam"    length="60"/>
		      <Item name="LogNo"     length="14"/>  	
		      <Item name="RecSts"    length="1"/>  	
 		    </PackItem>
            <Item name="TmpNam" head_len="3"/>
          </Group>
        </PackItem>
        <Item name="TmpDat" head_len="4" include_len="yes"/>
        <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 收费项目代码增加 -->
  <Transaction code="463806" service="463806" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgCod" 	length="10"/>        <!--收费编码-->
      <Item name="CrgItm" 	length="60"/>       <!--收费项目-->
      <Item name="CrgDpt" 	length="60"/>       <!--收费单位-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!-- 收费项目代码获取收费单位 -->
  <Transaction code="463863" service="463863" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgCod" 	length="5" />        <!--收费编码-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="D00"/>
            <Item name="CrgDpt" 	length="60"/>        <!--收费单位-->
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 收费项目代码修改 -->
  <Transaction code="463807" service="463807" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgCod" 	length="10"/>        <!--收费编码-->
      <Item name="CrgItm" 	length="60"/>       <!--收费项目-->
      <Item name="CrgDpt" 	length="60"/>       <!--收费单位-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!-- 多页查询收费项目信息 -->
  <Transaction code="463808" service="463808" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="CrgCod" 	length="10"/>        <!--收费编码-->
      </Else>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="Z01"/>
            <Item name="PageNo" length="4" value="0001"/>
            <Item name="VarSiz" length="1" value="3"/>
            <Item name="Ttl"    head_len="3" value="  查询收费项目信息  "/>
            <Item name="SubTtl" head_len="3" value=" 收费代码       收费项目    收费单位"/>
            <Group name="Rec" repeat_name="RecNum">
              <PackItem name="TmpNam">
                <Item name="CrgCod"   length="10"/>
                <Item name="CrgItm"   length="30" expression="SUBSTR($CrgItm,1,30)"/>
                <Item name="CrgDpt"   length="30" expression="SUBSTR($CrgDpt,1,30)"/>
              </PackItem>
              <Item name="TmpNam" head_len="3"/>
            </Group>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 行政收费明细查询 -->
  <Transaction code="463832" service="463832" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="QryDat" length="8"/>
      <Item name="LogNo"  length="14"/>
    </Request>
    <Response necessary="no">
      <AddItem name="SAplCd" value="46"/>
      <AddItem name="STxnCd" value="3833"/>
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="X01"/>
            <Item name="ROOT.ROOT_1.RcpTyp"   	length="1"/>
            <Item name="ROOT.ROOT_1.RcpNo"   	length="15"/>
            <Item name="ROOT.ROOT_1.CcyCod"   	length="3"/>
            <Item name="ROOT.ROOT_1.CusNam" 	length="60"/>
            <Item name="ROOT.ROOT_1.BilSqn" 	length="12"/>
            <Group name="ROOT" repeat_name="RecNum">
              <Item name="CrgCod" 	length="10"/>
              <Item name="CrgUni"   length="6"/>
              <Item name="UniPri" 	length="12"/>
              <Item name="UniNum" 	length="6"/>
              <Item name="ItmAmt" 	length="12"/>
              <Item name="CrgItm" 	length="60"/>
            </Group>
            <If condition="INTCMP($RecNum,3,1)=1">
               <Item name="ItmDat" length="212"/>
            </If>
            <ElseIf condition="INTCMP($RecNum,3,2)=1">
               <Item name="ItmDat" length="106"/>
            </ElseIf>
            <Item name="ROOT.ROOT_1.TxnAmt" 	length="15"/>
            <Item name="ROOT.ROOT_1.CrgDpt" 	length="60"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 收费项目代码删除 -->
  <Transaction code="463810" service="463810" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgCod" 	length="10"/>        <!--收费编码-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!--抹账查询-->
  <Transaction code="463834" service="463834" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="OTckNo" length="11" desc="会计流水号"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="D00"/>
            <Item name="ROOT.ROOT_1.RcpTyp"   	length="1"/>
            <Item name="ROOT.ROOT_1.RcpNo"   	length="15"/>
            <Item name="ROOT.ROOT_1.CcyCod"   	length="3"/>
            <Item name="ROOT.ROOT_1.CusNam" 	length="60"/>
            <Item name="ROOT.ROOT_1.BilSqn" 	length="12"/>
            <Group name="ROOT" repeat_name="RecNum">
              <Item name="CrgCod" 	length="10"/>
              <Item name="CrgUni"   length="6"/>
              <Item name="UniPri" 	length="12"/>
              <Item name="UniNum" 	length="6"/>
              <Item name="ItmAmt" 	length="12"/>
              <Item name="CrgItm" 	length="60"/>
            </Group>
            <If condition="INTCMP($RecNum,3,1)=1">
               <Item name="ItmDat" length="212"/>
            </If>
            <ElseIf condition="INTCMP($RecNum,3,2)=1">
               <Item name="ItmDat" length="106"/>
            </ElseIf>
            <Item name="TxnAmt" 	length="15"/>
            <Item name="ROOT.ROOT_1.CrgDpt" 	length="60"/>
            <Item name="OLogNo" length="14" desc="前置流水号"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--现金交款抹账-->
  <Transaction code="463809" service="463809" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="OTckNo" 	length="11"/>
      <Item name="OLogNo"   length="14" desc="前置流水号"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>    
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="46" />
            <Item name="OFmtCd1" length="3" value="K81" />
            <Item name="RspMsg" length="56" value="交易成功！"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 收取网点数据 -->
  <Transaction code="463812" service="463812" timeout="200" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="Option" length="1"/>	<!--选项-->
      <Item name="IptDat" length="8"/>	<!--日期-->
      <Item name="CcyCod" length="3"/>	<!--货币-->
      <AddItem name="Month" length="2" expression="SUBSTR($IptDat,5,2)"/>
      <SwitchCode name="Month" tab_name="Month" col_name="Month"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!--全行轧账单-->
  <Transaction code="463813" service="463813" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="PrtDat" 	length="8"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!-- 查询当日现金交易 -->
  <Transaction service="463825" code="463825" log_switch="0">
     <Request>
       <Include file="etc/TRMTIA_IIT.XML"/>
       <Item name="IptDat"   length="8"/>
       <Item name="CcyCod"   length="3"/>
       <Item name="CrgTyp"   length="1"/>
       <AddItem name="AplSub" value="002"/>
     </Request>
     <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
	        <Item name="ApCode" length="2" value="46"/>
      	    <Item name="OFmtCd" length="3" value="D00"/>
            <Item name="TxnAmt" length="15"/>
            <Item name="ActNo"  length="21"/>
            <Item name="DptNam"  length="60"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!-- 现金缴款结转 -->
  <Transaction code="463814" service="463814" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="IptDat" length="8"/>	<!--划账日期-->
      <Item name="CcyCod" length="3"/>
      <Item name="CrgTyp" length="1"/>	<!--收费种类-->
      <Item name="TxnAmt" length="15"/>	<!--收费金额-->
      <Item name="TActNo" length="21"/> <!--收款账号-->
      <Item name="TCusNm" length="60"/> <!--收款名称-->
      <AddItem name="AplSub" value="002"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <!--If condition="$IsChk=0">
            <PackItem name="TmpDat">
              <Item name="ApCode" length="2" value="46"/>
              <Item name="OFmtCd" length="3" value="Z01"/>
              <Item name="PageNo" length="4" value="0001"/>
              <Item name="VarSiz" length="1" value="3"/>
              <Item name="Ttl"    head_len="3" value="  查询各末轧账网点"/>
              <Item name="SubTtl" head_len="3" value=" 未轧账网点"/>
              <Group name="Rec" repeat_name="RecNum">
                <PackItem name="TmpNam">
                  <Item name="NodNo"   length="6"/>
                </PackItem>
                <Item name="TmpNam" head_len="3"/>
              </Group>
            </PackItem>
            <Item name="TmpDat" head_len="4" include_len="yes"/>
            <Break/>
          </If>
          <Else-->
            <PackItem name="TmpDat">
              <Item name="ApCode" length="2" value="46"/>
              <Item name="OFmtCd" length="3" value="H70"/>
              <Item name="PayNam" length="30"/>   
              <Item name="TCusNm" length="60"/>   
              <Item name="ActNo"  length="21"/> 
              <Item name="TActNo" length="21"/>  
              <Item name="CapAmt" length="46" expression="AMTTOCAP($TxnAmt)"/>
              <Item name="PrtAmt" length="26" align_mode="right"/>
              <Item name="TckNo" length="11"/>
            </PackItem>                       
            <Item name="TmpDat" head_len="4" include_len="yes"/>
            <Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
            <Break/>
          <!--/Else-->
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 数据统计打印拷盘 -->
  <Transaction code="463815" service="463815" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="QCcyCod" length="3"/>
      <Item name="QNodNo" length="6"/>
      <Item name="QCrgCod" length="10"/>
      <Item name="BgnDat" length="8"/>	<!--起始日期-->
      <Item name="EndDat" length="8"/>	<!--终止日期-->
      <Item name="PrtOpt" length="1"/>	<!--打印选项-->
      <Item name="CpyOpt" length="1"/>	<!--拷盘选项-->
      <Item name="QRecSts" length="1"/>
    </Request>
    <Response necessary="no">
      <If condition="$CpyOpt=0">
        <AddItem name="SAplCd" value="46"/>
        <AddItem name="STxnCd" value="3865"/>
      </If>
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <If condition="$CpyOpt=0">
           <PackItem name="TmpDat">
             <Item name="ApCode"   length="2"   value="46"/>
             <Item name="OFmtCd"   length="3"   value="X01"/>
             <Item name="RptFil"   length="60"  />
           </PackItem>
          </If>
          <ElseIf condition="$CpyOpt=1">
            <PackItem name="TmpDat">
              <Item name="ApCode"  length="2" value="46"/>
              <Item name="OFmtCd"  length="3" value="K81"/>
              <Item name="RspMsg"  length="60" value="交易成功"/>
            </PackItem>
          </ElseIf>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
             <Item name="ApCode1" length="2" value="SC"/>
             <Item name="OFmtCd1" length="3" value="D04"/>
             <Item name="RspCod" length="6"/>
             <Item name="InPos"  length="4" value="0001"/>
             <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!--转账交易抹账查询-->
  <Transaction code="463819" service="463819" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="TckNo"  length="11"/>
        <Item name="VchSeq" length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
        <Item name="OprTyp" length="1"/>
        <Item name="RcpNo"  length="15"/>
      </Else>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
          <Item name="ApCode"  length="2"   value="35"/>
          <Item name="OFmtCd"  length="3"   value="Z01"/>
          <Item name="PagNo"   length="4"   value="0001"/>
          <Item name="VarSize" length="1"   value="3"/>
          <Item name="Ttl"     head_len="3" value="  转账交易抹账明细  "/>
          <Item name="SubTtl"  head_len="3" value=" 流 水 号   小 序 号   金 额  收据编号  状态   缴 款 人 抹账方式"/>
          <Group name="Rec" repeat_name="RecNum">
            <PackItem name="TmpNam">
              <Item name="TckNo"     length="11"/>
              <Item name="VchSeq"    length="2" expression="AMTDELZERO($VchSeq)"/>
              <Item name="RcpTyp"    length="1"/>
              <Item name="ItmAmt"    length="12"/>
              <Item name="RcpNo"     length="15"/>
              <Item name="RecSts"    length="1"/>
              <Item name="CusNam"    length="60"/>
              <Item name="OprTyp"    length="1"/>
            </PackItem>
            <Item name="TmpNam" head_len="3"/>
          </Group>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
             <Item name="ApCode1" length="2" value="SC"/>
             <Item name="OFmtCd1" length="3" value="D04"/>
             <Item name="RspCod" length="6"/>
             <Item name="InPos"  length="4" value="0001"/>
             <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!--转账交易抹账-->
  <Transaction code="463851" service="463851" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="TckNo"    length="11"/>
      <Item name="VchSeq"   length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
      <Item name="CAtTyp"   length="1"/>
      <Item name="RcpNo"    length="15"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
             <Item name="ApCode1" length="2" value="SC"/>
             <Item name="OFmtCd1" length="3" value="D04"/>
             <Item name="RspCod" length="6"/>
             <Item name="InPos"  length="4" value="0001"/>
             <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!--转账交易抹账-->
  <Transaction code="463852" service="463851" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="TckNo"    length="11"/>
      <Item name="VchSeq"   length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
      <Item name="CAtTyp"   length="1"/>
      <Item name="RcpNo"    length="15"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
             <Item name="ApCode1" length="2" value="SC"/>
             <Item name="OFmtCd1" length="3" value="D04"/>
             <Item name="RspCod" length="6"/>
             <Item name="InPos"  length="4" value="0001"/>
             <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!-- 现金缴款结转抹账 -->
  <Transaction code="463829" service="463829" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="OTckNo" 	length="11"/>
      <Item name="OLogNo"   length="14" desc="前置流水号"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="46" />
            <Item name="OFmtCd1" length="3" value="K81" />
            <Item name="RspMsg" length="56" value="交易成功！"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>
  
  <!--抹账查询-->
  <Transaction code="463854" service="463854" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="OTckNo" length="11" desc="会计流水号"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="D00"/>
            <Item name="TxnAmt" length="15"/>       <!--划账金额-->           
            <Item name="ActNo" 	length="21"/>       <!--收款账号-->
            <Item name="TCusNm" length="60"/>        <!--收款名称-->
            <Item name="OLogNo" length="14" desc="前置流水号"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--抹账明细嵌套-->
  <Transaction code="463823" server="OFRTCAD1" service="463823" log_switch="0" timeout="30">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="TckNo" 	length="11"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <If condition="$MsgTyp=N">
	    <PackItem name="TMP">
	      <Item name="ApCode" length="2" value="46"/>
      	      <Item name="OFmtCd" length="3" value="H64"/>
      	      <Item name="BilSqn" length="12"/>
      	      <Item name="CrgWay" length="1"/>
      	      <Item name="CusNam" length="60"/>
      	      <Item name="CrgDpt" length="60"/>
              <Item name="TxnAmt" length="15"/>
	    </PackItem>
	    <Item name="TMP" head_len="4" include_len="yes"/>
      </If>
      <Else>
	    <Item name="RspMsg" head_len="4" include_len="yes"/>
      </Else>
    </Response>
  </Transaction>

  <!--网点现金缴款结转情况查询-->
  <Transaction code="463816" service="463816" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="QBgnDat"  length="8"/>
        <Item name="QEndDat"  length="8"/>
        <Item name="QNodNo"   length="6"/>
        <Item name="QCrgTyp"  length="1"/>
        <Item name="Status"  length="1"/>
      </Else>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
        <PackItem name="TmpDat">
          <Item name="ApCode1" length="2" value="46"/>
          <Item name="OFmtCd1" length="3"   value="Z01"/>
          <Item name="PagNo"   length="4"   value="0001"/>
          <Item name="VarSize" length="1"   value="3"/>
          <Item name="Ttl"     head_len="3" value="  网点现金缴款结转情况查询  "/>
          <Item name="SubTtl"  head_len="3" value=" 日期  网点号 结转状态"/>
          <Group name="Rec" repeat_name="RecNum"> 
            <PackItem name="TmpNam">                      	
              <Item name="TxnDat"   length="8"/>
		      <Item name="NodNo"     length="6"/>  	
		      <Item name="ROOT.ChnSts"    length="6"/>  	
 		    </PackItem>
            <Item name="TmpNam" head_len="3"/>
          </Group>
        </PackItem>
        <Item name="TmpDat" head_len="4" include_len="yes"/>
        <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

</Application>

