<?xml version='1.0' encoding='ISO-8859-1'?>
<Application name="CCP" pre_dll="dll/pre_term.so" pre_func="pre_term" spe_dll="dll/pre_term.so" spe_func="spe_term" server="OFRTCCP1" trace="no">
  <CodeSwitching>
    <Table name="StsChn" file="/app/ics/app/cadb/etc/CAD_CSW.XML">
      <Column name="RecSts" sort="no"/>
      <Column name="StsChn" sort="no"/>
    </Table>
    <Table name="WayChn" file="/app/ics/app/cadb/etc/CAD_CSW.XML">
      <Column name="CrgWay" sort="no"/>
      <Column name="WayChn" sort="no"/>
    </Table>
    <Table name="Month" file="/app/ics/app/cadb/etc/CAD_CSW.XML">
      <Column name="Month" sort="no"/>
      <Column name="MthIdx" sort="no"/>
    </Table>
    <Table name="DitCap" file="/app/ics/app/cadb/etc/CAD_CSW.XML">
      <Column name="DitCap" sort="no"/>
      <Column name="Des" sort="no"/>
    </Table>
<!-- add for 自助缴费 start-->    
    <Table name="TxnCnl" file="/app/ics/app/srfb/etc/SRFA_CSW_444999.XML">
      <Column name="OrnFlg"  sort="no"/>
      <Column name="TxnCnl"  sort="no"/>
    </Table>
    <Table name="CnlDes" file="/app/ics/app/srfb/etc/SRFA_CSW_444999.XML">
      <Column name="TxnCnl"  sort="no"/>
      <Column name="CnlDes"  sort="no"/>
    </Table>
    <Table name="CnlTyp" file="/app/ics/app/srfb/etc/SRFA_CSW_444999.XML">
      <Column name="OrnFlg"  sort="no"/>
      <Column name="CnlTyp"  sort="no"/>
    </Table>    
<!-- add for 自助缴费 end-->        
  </CodeSwitching>
  <Define>
    <!-- 现金缴款记账请求 -->
    <Macro name="ccp_request01">
      <Item name="RcpTyp"  	length="1"/>
      <Item name="RcpNo"   	length="15"/>
      <Item name="CshNo" 	length="3"/>
      <Item name="CusNam" 	length="60"/>
      <Item name="ShlCod" 	length="10"/>
      <Item name="ShlNam" 	length="60"/>
      <Item name="ShlGr" 	length="2"/>
      <Item name="SubNam" 	length="60"/>
      <Item name="TxnAt1" length="12"/>    <!--学杂费-->
      <Item name="TxnAt2" length="12"/>    <!--住宿费-->
      <Item name="TxnAt3" length="12"/>    <!--实习试验费-->
      <Item name="TxnAt4" length="12"/>    <!--补考费-->
      <Item name="TxnAt5" length="12"/>    <!--重修费-->
      <Item name="TxnAt6" length="12"/>    <!--其他-->
      <Item name="TxnAmt" length="15"/>    <!--合计-->
    </Macro>
    <!-- 转账请求 -->
    <Macro name="ccp_request02">
      <Item name="TckNo" 	length="11"/>
      <Item name="VchSeq" 	length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
      <Item name="STotAmt" 	length="15"/>
      <Item name="SpsAmt" 	length="15"/>
      <Item name="RcpTyp"  	length="1"/>
      <Item name="RcpNo"   	length="15"/>
      <Item name="CusNam" 	length="60"/>
      <Item name="ShlCod" 	length="10"/>
      <Item name="ShlNam" 	length="60"/>
      <Item name="ShlGr" 	length="2"/>
      <Item name="SubNam" 	length="60"/>
      <Item name="TxnAt1" length="12"/>    <!--学杂费-->
      <Item name="TxnAt2" length="12"/>    <!--住宿费-->
      <Item name="TxnAt3" length="12"/>    <!--实习试验费-->
      <Item name="TxnAt4" length="12"/>    <!--补考费-->
      <Item name="TxnAt5" length="12"/>    <!--重修费-->
      <Item name="TxnAt6" length="12"/>    <!--其他-->
      <Item name="TxnAmt" length="15"/>    <!--合计-->
    </Macro>
    <!-- 现金缴款记账响应 -->
    <Macro name="ccp_response01">
      <Item name="TckNo"  length="11"/>
      <Item name="RcpNo"  length="15"/>
      <Item name="CusNam" length="30" expression="SUBSTR($CusNam,1,30)"/>
      <Item name="ShlNam" length="60"/>	   <!--校名-->    
      <Item name="ShlGr"  length="2"/> 	   <!--年级-->    
      <Item name="SubNam" length="60"/>	   <!--专业名称-->
      <Item name="TxnAt1" length="12"/>    <!--学杂费-->
      <Item name="TxnAt2" length="12"/>    <!--住宿费-->
      <Item name="TxnAt3" length="12"/>    <!--实习试验费-->
      <Item name="TxnAt4" length="12"/>    <!--补考费-->
      <Item name="TxnAt5" length="12"/>    <!--重修费-->
      <Item name="TxnAt6" length="12"/>    <!--其他-->
      <Item name="TxnAmt" length="15" expression="AMTSIMPLEFMT($TxnAmt)"/>    <!--合计-->
      <Item name="CapAmt" length="50"  align_mode="right"/>
    </Macro>
    <!-- add for 自助通卡缴款记账请求 -->
    <Macro name="ccp_request03">
      <!--AddItem name="CnlTyp" 	value="5"/-->   	<!--确定渠道-多媒体-->
      <AddItem name="OrnFlg" expression="SUBSTR($TxnSrc,1,1)"/>
      <SwitchCode name="OrnFlg" new_name="TxnCnl"  tab_name="TxnCnl" col_name="OrnFlg"/>
      <SwitchCode name="OrnFlg" new_name="CnlTyp"  tab_name="CnlTyp" col_name="OrnFlg"/>
      <AddItem name="Mask" 	value="9115"/>	<!--确定渠道-摘要码（9115 代扣学杂费）从前端S_field.hlp查得-->
      <AddItem name="VchChk"	value="0"/> 	<!--监督标志 0-不监督 1-监督 2-有凭证不监督-->
      <AddItem name="CAgtNo"	value="4440000004"/> 	<!--大中专收费单位编号，上线时需要加好，4440000893是测试时用属营业部的编号 4440000004是中小学暂收户编号-->
      <AddItem name="VchCod"	value="00000000"/> 	<!--凭证号码-->
      <AddItem name="PayMod"	value="0"/> 	<!--支取方式 1 凭密支取 2 凭印支取 3 凭证支取 4 任意支取 5 签字支取 6 支付密码 7 电子验印 0 不验密-->
      <AddItem name="CcyTyp"	value="0"/> 	<!--钞汇标志 0-钞 1-汇-->
      <Item name="ActNo" 	length="21" expression="DELBOTHSPACE($ActNo)"/>  <!--卡号-->
      <!--Item name="PinBlk"	length="20"/-->  <!--密码-->
      <Item name="RcpTyp"  	length="1"/>
      <Item name="RcpNo"   	length="15"/>	<!--收据编号，自助通无法提供，考虑使用yyyymmddhhmmss-->
      <Item name="CshNo" 	length="3"/>
      <Item name="CusNam" 	length="60"/>
      <Item name="ShlCod" 	length="10"/>
      <Item name="ShlNam" 	length="60"/>
      <Item name="ShlGr" 	length="2"/>
      <Item name="SubNam" 	length="60"/>
      <Item name="TxnAt1" length="12"/>    <!--学杂费-->
      <Item name="TxnAt2" length="12"/>    <!--住宿费-->
      <Item name="TxnAt3" length="12"/>    <!--实习试验费-->
      <Item name="TxnAt4" length="12"/>    <!--补考费-->
      <Item name="TxnAt5" length="12"/>    <!--重修费-->
      <Item name="TxnAt6" length="12"/>    <!--其他-->
      <Item name="TxnAmt" length="15"/>    <!--合计-->
      <!--重新赋值收据编号，自助通无法提供，暂定使用学籍编号和姓名组合-->
      <AddItem name="RcpNo"   	length="15" expression="STRCAT(DELBOTHSPACE($ShlCod),DELBOTHSPACE(SUBSTR($CusNam,1,8)))" />
    </Macro>
    <!-- add for 自助通卡缴款记账响应 -->
    <Macro name="ccp_response03">
      <Item name="TckNo"  length="11"/>
      <Item name="RcpNo"  length="15"/>
      <Item name="CusNam" length="30" expression="SUBSTR($CusNam,1,30)"/>
      <Item name="ShlNam" length="60"/>	   <!--校名-->    
      <Item name="ShlGr"  length="2"/> 	   <!--年级-->    
      <Item name="SubNam" length="60"/>	   <!--专业名称-->
      <Item name="TxnAt1" length="12"/>    <!--学杂费-->
      <Item name="TxnAt2" length="12"/>    <!--住宿费-->
      <Item name="TxnAt3" length="12"/>    <!--实习试验费-->
      <Item name="TxnAt4" length="12"/>    <!--补考费-->
      <Item name="TxnAt5" length="12"/>    <!--重修费-->
      <Item name="TxnAt6" length="12"/>    <!--其他-->
      <Item name="TxnAmt" length="15" expression="AMTSIMPLEFMT($TxnAmt)"/>    <!--合计-->
      <!--Item name="CapAmt" length="50"  align_mode="right"/-->
    </Macro>
  </Define>

  <!--现金缴款记账-->
  <Transaction code="465501" service="465501" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Quote name="ccp_request01"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="L06"/>
            <Quote name="ccp_response01"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--现金缴款记账嵌套-->
  <Transaction code="465521" service="465521" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="ShlCod" 	length="10"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
       <Switch expression="$MsgTyp">
         <Case value="N">
           <PackItem name="TmpDat">
             <Item name="ApCode" length="2" value="46"/>
             <Item name="OFmtCd" length="3" value="D00"/>
             <Item name="ShlNam" length="60"/>       <!--校名-->
             <Item name="ShlGr"  length="2"/>        <!--年级-->
             <Item name="SubNam" length="60"/>       <!--专业名称-->
           </PackItem>
           <Item name="TmpDat" head_len="4" include_len="yes"/>
           <Break/>
         </Case>
         <Case value="E">
           <PackItem name="TmpDat">
             <Item name="ApCode1" length="2" value="SC"/>
             <Item name="OFmtCd1" length="3" value="D04"/>
             <Item name="RspCod" length="6"/>
             <Item name="InPos"  value="0001"/>
             <Item name="RspMsg" length="56"/>
           </PackItem>
           <Item name="TmpDat" head_len="4" include_len="yes"/>
           <Break/>
         </Case>
         <Case value="A">
           <Item name="BillText" deli_asc="-1" />
           <Break/>
         </Case>
       </Switch>
    </Response>
  </Transaction>

  <!--转账-->
  <Transaction code="465502" service="465502" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgWay"  length="1"/>
      <Quote name="ccp_request02"/>
    </Request>
    <Response necessary="no">
      <AddItem name="SAplCd" value="46"/>
      <AddItem name="STxnCd" value="5541"/>
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="L06"/>
            <Quote name="ccp_response01"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <If condition="INTCMP($SpsAmt,6,0)">
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46" />
              <Item name="OFmtCd1"  length="3" value="X01" />
              <Item name="CrgWay"  length="1"/>
	          <Item name="TckNo"   length="11"/>
              <Item name="VchSeq"  length="2" expression="AMTDELZERO($VchSeq)"/>
              <Item name="STotAmt" 	length="15" expression="ADDCHAR($STotAmt,15,0,1)"/>
              <Item name="SpsAmt" 	length="15" expression="ADDCHAR($SpsAmt,15,0,1)"/>
            </PackItem>
          </If>
          <Else>
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46"/>
              <Item name="OFmtCd1"  length="3" value="K81"/>
              <Item name="RspMsg"  length="60" value="交易成功"/>
            </PackItem>
          </Else>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 转账上主机查询交易 -->
  <Transaction service="465524" code="465524" log_switch="0">
     <Request>
       <Include file="etc/TRMTIA_IIT.XML"/>
       <Item name="CrgWay"  length="1"/>
       <Item name="TckNo"   length="11"/>
       <Item name="VchSeq"  length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
     </Request>
     <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="46"/>
            <Item name="OFmtCd1" length="3" value="D00"/>
            <Item name="TxnAmt" length="15" expression="ADDCHAR($TxnAmt,15,0,1)"/>
            <Item name="SpsAmt" length="15" expression="ADDCHAR($SpsAmt,15,0,1)"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--转账-->
  <Transaction code="465541" service="465502" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="CrgWay"  length="1"/>
      <Quote name="ccp_request02"/>
    </Request>
    <Response necessary="no">
      <AddItem name="SAplCd" value="46"/>
      <AddItem name="STxnCd" value="5541"/>
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="L06"/>
            <Quote name="ccp_response01"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <If condition="INTCMP($SpsAmt,6,0)">
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46" />
              <Item name="OFmtCd1"  length="3" value="X01" />
              <Item name="CrgWay"  length="1"/>
	          <Item name="TckNo"   length="11"/>
              <Item name="VchSeq"  length="2" expression="AMTDELZERO($VchSeq)"/>
              <Item name="STotAmt" 	length="15" expression="ADDCHAR($STotAmt,15,0,1)"/>
              <Item name="SpsAmt" 	length="15" expression="ADDCHAR($SpsAmt,15,0,1)"/>
            </PackItem>
          </If>
          <Else>
            <PackItem name="TmpDat">
              <Item name="ApCode1"  length="2" value="46"/>
              <Item name="OFmtCd1"  length="3" value="K81"/>
              <Item name="RspMsg"  length="60" value="交易成功"/>
            </PackItem>
          </Else>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--打印流水清单-->
  <Transaction code="465504" service="465504" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="QryDat" 	length="8"/>
      <Item name="QNodNo" 	length="6"/>
      <Item name="PrtFlg" 	length="1"/>      
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>
 
  <!-- 大中专收费流水查询 -->
  <Transaction code="465505" service="465505" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="QActDat"  length="8"/>
        <Item name="QNodNo"   length="6"/>
        <Item name="QTlrId"   length="7"/>
        <Item name="QTckNo"   length="11"/>
        <Item name="QTxnAmt"  length="15"/>
        <Item name="QShlCod"  length="10"/>
        <Item name="QRcpNo"   length="15"/>
        <Item name="QCusNam"  length="60"/>
        <Item name="QRecSts"  length="1"/>
      </Else>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
        <PackItem name="TmpDat">
          <Item name="ApCode"    length="2" value="46"/>
          <Item name="OFmtCd"  length="3"   value="Z01"/>
          <Item name="PagNo"   length="4"   value="0001"/>
          <Item name="VarSize" length="1"   value="3"/>
          <Item name="Ttl"     head_len="3" value="  转账交易抹账明细  "/>
          <Item name="SubTtl"  head_len="3" value=" 流 水 号   小 序 号   金 额  收据编号  状态   缴 款 人 抹账方式"/>
          <Group name="Rec" repeat_name="RecNum">
            <PackItem name="TmpNam">
            <Item name="TckNo"     length="11"/>                              
            <Item name="VchSeq"    length="2" expression="AMTDELZERO($VchSeq)"/>
            <Item name="QryDat"    length="8"/>
            <SwitchCode name="RecSts" new_name="StsChn"  tab_name="StsChn"  col_name="RecSts"/>
            <Item name="StsChn"    length="4"/>
            <Item name="RcpNo"     length="15"/>                              
            <SwitchCode name="CrgWay" new_name="WayChn"  tab_name="WayChn"  col_name="CrgWay"/>
            <Item name="WayChn"    length="4"/>
            <Item name="TxnAmt"    length="15"/>        
            <Item name="CusNam"    length="60"/>                              
            <Item name="RcpTyp"    length="1"/>
      	    <Item name="ShlCod"    length="10"/>                              
      	    <Item name="ShlNam"    length="60"/>                              
      	    <Item name="ShlGr"     length="2 "/>                              
            <Item name="SubNam"    length="60"/>                              
            <Item name="TxnAt1"    length="12"/>                              
            <Item name="TxnAt2"    length="12"/>                              
            <Item name="TxnAt3"    length="12"/>                              
            <Item name="TxnAt4"    length="12"/>                              
            <Item name="TxnAt5"    length="12"/>                              
            <Item name="TxnAt6"    length="12"/>                              
            <Item name="RecSts"    length="1"/>    
          </PackItem>
          <Item name="TmpNam" head_len="3"/>                   
          </Group>  
        </PackItem>
        <Item name="TmpDat" head_len="4" include_len="yes"/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 学校班级代码增加 -->
  <Transaction code="465506" service="465506" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="ShlCod" 	length="10"/>       <!--学校班级编码-->
      <Item name="ShlNam" 	length="60"/>       <!--校名-->
      <Item name="ShlGr" 	length="2"/>        <!--年级-->
      <Item name="SubNam" 	length="60"/>       <!--专业名称-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>
  
  <!-- 收费项目代码获取收费单位 -->
  <Transaction code="465563" service="465563" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="ShlCod" 	length="2" expression="SUBSTR($ShlCod,1,2)"/>        <!--学校班级编码-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="D00"/>
            <Item name="ShlNam" 	length="60"/>        <!--校名-->
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>
  
  <!-- 学校班级代码修改 -->
  <Transaction code="465507" service="465507" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="ShlCod" 	length="10"/>       <!--学校班级编码-->
      <Item name="ShlNam" 	length="60"/>       <!--校名-->
      <Item name="ShlGr" 	length="2"/>        <!--年级-->
      <Item name="SubNam" 	length="60"/>       <!--专业名称-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!-- 多页查询学校班级代码信息 -->
  <Transaction code="465508" service="465508" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="ShlCod" 	length="10"/>        <!--收费编码-->
      </Else>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="Z01"/>
            <Item name="PageNo" length="4" value="0001"/>
            <Item name="VarSiz" length="1" value="3"/>
            <Item name="Ttl"    head_len="3" value="  查询学校代码信息  "/>
            <Item name="SubTtl" head_len="3" value=" 学校班级编码       校名    年级	专业名称"/>
            <Group name="Rec" repeat_name="RecNum">
              <PackItem name="TmpNam">
                <Item name="ShlCod" 	length="10"/>        <!--学校班级编码-->
      		    <Item name="ShlNam" 	length="20"  expression="SUBSTR($ShlNam,1,20)"/>       <!--校名-->
      		    <Item name="ShlGr" 	length="2"/>        <!--年级-->
      	    	<Item name="SubNam" 	length="20"  expression="SUBSTR($SubNam,1,20)"/>       <!--专业名称-->
              </PackItem>
              <Item name="TmpNam" head_len="3"/>
            </Group>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!-- 学校班级代码删除 -->
  <Transaction code="465510" service="465510" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="ShlCod" 	length="10"/>        <!--收费编码-->
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!--现金缴款抹账-->
  <Transaction code="465509" service="465509" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="OTckNo"   length="11"/>
      <Item name="OLogNo"   length="14" desc="前置流水号"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="46" />
            <Item name="OFmtCd1" length="3" value="K81" />
            <Item name="RspMsg" length="56" value="交易成功！"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--抹账明细嵌套-->
  <Transaction code="465523" service="465523" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="OTckNo" 	length="11"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
	      <PackItem name="TmpDat">
	        <Item name="ApCode" length="2" value="46"/>
            <Item name="OFmtCd" length="3" value="D00"/>
        	<Item name="CusNam" length="60"/>
          	<Item name="ShlCod" length="10"/>
            <Item name="ShlNam" length="60"/>
            <Item name="ShlGr"  length="2 "/>
            <Item name="SubNam" length="60"/>  
            <Item name="TxnAt1" length="12"/>
            <Item name="TxnAt2" length="12"/>
            <Item name="TxnAt3" length="12"/>
            <Item name="TxnAt4" length="12"/>
            <Item name="TxnAt5" length="12"/>
            <Item name="TxnAt6" length="12"/>
            <Item name="TxnAmt" length="15"/>
            <Item name="OLogNo" length="14" desc="前置流水号"/>
	      </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--转账交易抹账查询-->
  <Transaction code="465519" service="465519" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <If condition="IS_EQUAL_STRING($TIATyp,P)">
        <Item name="PagIdx"  length="6"/>
      </If>
      <Else>
        <Item name="TckNo" 	length="11"/>
        <Item name="VchSeq" length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
        <Item name="OprTyp" length="1"/>
        <Item name="RcpNo" 	length="15"/>
      </Else>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2"   value="46"/>
            <Item name="OFmtCd"  length="3"   value="Z01"/>
            <Item name="PagNo"   length="4"   value="0001"/>
            <Item name="VarSize" length="1"   value="3"/>
            <Item name="Ttl"     head_len="3" value="  转账交易抹账明细  "/>
            <Item name="SubTtl"  head_len="3" value=" 流 水 号   小 序 号   金 额  收据编号  状态   缴 款 人 抹账方式"/>
            <Group name="Rec" repeat_name="RecNum">
              <PackItem name="TmpNam">
                <Item name="TckNo"     length="11"/>
                <Item name="VchSeq"    length="2" expression="AMTDELZERO($VchSeq)"/>
                <Item name="RcpTyp"    length="1"/>
                <Item name="RcpNo"     length="15"/>
                <Item name="CusNam"    length="60"/>
      	        <Item name="ShlCod"    length="10"/>
      	        <Item name="ShlNam"    length="60"/>
      	        <Item name="ShlGr"     length="2 "/>
                <Item name="SubNam"    length="60"/>
                <Item name="TxnAt1"    length="12"/>
                <Item name="TxnAt2"    length="12"/>
                <Item name="TxnAt3"    length="12"/>
                <Item name="TxnAt4"    length="12"/>
                <Item name="TxnAt5"    length="12"/>
                <Item name="TxnAt6"    length="12"/>
                <Item name="TxnAmt"    length="15"/>
                <Item name="OprTyp"    length="1"/>
              </PackItem>
              <Item name="TmpNam" head_len="3"/>
            </Group>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>

  <!--转账交易抹账-->
  <Transaction code="465551" service="465551" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="TckNo" 	length="11"/>
      <Item name="VchSeq"   length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
      <Item name="CAtTyp" 	length="1"/>
      <Item name="RcpNo" 	length="15"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>

  <!--转账交易抹账-->
  <Transaction code="465552" service="465551" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="TckNo" 	length="11"/>
      <Item name="VchSeq"   length="2" expression="ADDCHAR($VchSeq,4,0,1)"/>
      <Item name="CAtTyp" 	length="1"/>
      <Item name="RcpNo" 	length="15"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode"  length="2" value="46"/>
            <Item name="OFmtCd"  length="3" value="K81"/>
            <Item name="RspMsg"  length="60" value="交易成功"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch> 
    </Response>
  </Transaction>


	<!-- add for 自助通卡缴款记账 -->
	<Transaction code="465531" service="465531" log_switch="0">
		<Request>
			<Include file="etc/TRMTIA_IIT.XML"/>
			<Quote name="ccp_request03"/>
		</Request>
		<Response necessary="no">
			<Include file="etc/TRMTOA_IIT.XML"/>
			<Switch expression="$MsgTyp">
				<Case value="N">
					<PackItem name="TmpDat">
						<Item name="ApCode" length="2" value="46"/>
						<Item name="OFmtCd" length="3" value="L06"/>
						<Quote name="ccp_response03"/>
					</PackItem>
					<Item name="TmpDat" head_len="4" include_len="yes"/>
					<Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
					<Break/>
				</Case>
				<Case value="E">
					<PackItem name="TmpDat">
						<Item name="ApCode1" length="2" value="SC"/>
						<Item name="OFmtCd1" length="3" value="D04"/>
						<Item name="RspCod" length="6"/>
						<Item name="InPos"  value="0001"/>
						<Item name="RspMsg" length="56"/>
					</PackItem>
					<Item name="TmpDat" head_len="4" include_len="yes"/>
					<Break/>
				</Case>
				<Case value="A">
					<Item name="BillText" deli_asc="-1"/>
					<Break/>
				</Case>
			</Switch>
		</Response>
	</Transaction>

   <Transaction code="465532" desc="收据打印" log_switch="0">   <!--本交易仅打印网银和自助通办理的缴费收据-->
      <Request>
         <Include file="etc/TRMTIA_IIT.XML"/>
         <Item name="PrtMod"        length="1"/>   <!--打印方式(0:批量打印;1:单个打印)-->
         <Item name="StaDat"        length="8"      expression="DELBOTHSPACE($StaDat)"/>   <!--起始日期-->
         <Item name="EndDat"        length="8"      expression="DELBOTHSPACE($EndDat)"/>   <!--终止日期-->
          <Item name="OCusNam"        length="20"     expression="DELBOTHSPACE($OCusNam)"/>   <!--学生姓名-->
          <Item name="OShlCod"        length="7"     expression="DELBOTHSPACE($OShlCod)"/>   <!--学校班级编码-->
      </Request>
      <Response necessary="no">
         <Include file="etc/TRMTOA_IIT.XML"/>
         <Switch expression="$MsgTyp">
            <Case value="N">
            	<If condition="$PrtMod=1">
                  <PackItem name="TmpDat">
                     <Item name="ApFmt"     length="5" value="48D66"/>
                     <Item name="CusNam"    length="20"/><!--学生名称-->
                     <Item name="SubNam"    length="12"/><!--学籍编码-->
                     <Item name="ShlGr"     length="8"/><!--年级名称-->
                     <Item name="ShlNam"    length="16"/><!--学校名称-->
                     <Item name="TxnAmt"    length="15"/><!--总费用-->
                     <Item name="TxnAt1"    length="15"/><!--书杂费-->
                     <Item name="TxnAt2"    length="15"/><!--住宿费-->
                     <Item name="TxnAt3"    length="15"/><!--实习实验费-->
                     <Item name="TxnAt4"    length="15"/><!--补考费-->
                     <Item name="TxnAt5"    length="15"/><!--重修费-->
                     <Item name="TxnAt6"    length="15"/><!--其他费用-->
                     <Item name="OActDat"   length="8"/><!--缴费日期-->
                     <Item name="ONodNo"    length="11"/><!--原会计流水号-->
                     <Item name="OTckNo"    length="11"/><!--原会计流水号-->
                     <Item name="OLogNo"    length="14"/><!--原前置流水号-->
                     <Item name="OTlrId"    length="7"/><!--原柜员号-->
                  </PackItem>
                  <Item name="TmpDat" head_len="4" include_len="yes"/>
               </If>
               <Break/>
            </Case>
            <Case value="A">
               <Item name="BillText" deli_asc="-1"/>
               <Break/>
            </Case>
            <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
            </Case>
         </Switch>
      </Response>
   </Transaction>
   
 <!--自助缴费退费-->
  <Transaction code="465533" service="465533" log_switch="0">
    <Request>
      <Include file="etc/TRMTIA_IIT.XML"/>
      <Item name="OTckNo"   length="11"/>
      <Item name="OLogNo"   length="14" desc="前置流水号"/>
    </Request>
    <Response necessary="no">
      <Include file="etc/TRMTOA_IIT.XML"/>
      <Switch expression="$MsgTyp">
        <Case value="N">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="46" />
            <Item name="OFmtCd1" length="3" value="K81" />
            <Item name="RspMsg" length="56" value="交易成功！"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Item name="BillText" deli_asc="-1" pro_dll="dll/pre_sp.so" pro_func="spe_asctohex"/>
          <Break/>
        </Case>
        <Case value="E">
          <PackItem name="TmpDat">
            <Item name="ApCode1" length="2" value="SC"/>
            <Item name="OFmtCd1" length="3" value="D04"/>
            <Item name="RspCod" length="6"/>
            <Item name="InPos"  value="0001"/>
            <Item name="RspMsg" length="56"/>
          </PackItem>
          <Item name="TmpDat" head_len="4" include_len="yes"/>
          <Break/>
        </Case>
        <Case value="A">
          <Item name="BillText" deli_asc="-1"/>
          <Break/>
        </Case>
      </Switch>
    </Response>
  </Transaction>


   <Transaction code="465534" desc="自助渠道大中专学费轧账" log_switch="1" >
      <Request>
         <Include file="etc/TRMTIA_IIT.XML"/>
         <Item name="StaDat"        length="8"    expression="DELBOTHSPACE($StaDat)"/><!--起始日期-->
         <Item name="EndDat"        length="8"    expression="DELBOTHSPACE($EndDat)"/><!--终止日期-->
         <Item name="RknDat"        length="8"    expression="DELBOTHSPACE($RknDat)"/><!--清算日期-->
      </Request>
      <Response necessary="no">
         <Include file="etc/TRMTOA_IIT.XML"/>
         <Switch expression="$MsgTyp">
            <Case value="N">
               <PackItem name="TmpDat">
                  <Item name="ApFmt"    length="5" value="48D64"/>
                  <Item name="ChkFlg"   length="1"/><!--对账标志(1表示帐目平,以下文件名为轧帐报表文件;0表示帐目不平,以下文件名为错帐报表文件名)-->
                  <Item name="FilNam1"   length="30"/><!--文件名一-->
                  <Item name="FilNam2"   length="30"/><!--文件名二-->
               </PackItem>
               <Item name="TmpDat" head_len="4" include_len="yes"/>
               <Break/>
            </Case>
            <Case value="A">
               <Item name="BillText" deli_asc="-1"/>
               <Break/>
            </Case>
            <Case value="E">
               <Include file="etc/ERRFMT_IIT.XML"/>
               <Break/>
            </Case>
         </Switch>
      </Response>
   </Transaction>


</Application>
