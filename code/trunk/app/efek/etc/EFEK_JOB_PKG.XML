<?xml version='1.0' encoding='ISO-8859-1'?>
<Package>
  <TableDeclare>
    <Table name="afetxnjnl"    value="afetxnjnl"/>  <!--业务流水表-->
  </TableDeclare>

  <Function name="CheckOpenByEfeId" desc="使用EfeId查询供电局开工情况">
    <DynSentence name="QryInfCtl">             <!--查询开工信息表 -->
      <Sentence>
        SELECT StrAddr,DstAddr,WdoDat,CreOrg,OprCod,Status FROM efeinfctl WHERE EfeId='%s'
      </Sentence>
      <Fields>EfeId|</Fields>
    </DynSentence>
    <Process>
      <!--读取开工信息记录-->
      <Exec func="PUB:ReadRecord">
        <Arg name="SqlCmd" value="QryInfCtl"/>
      </Exec>
      <If condition="~RetCod!=0">
        <Set>RspCod=EFE999</Set>
        <Set>RspMsg=无$BrNo分行开工信息记录</Set>
        <Return/>
      </If>
      <If condition="$Status=0">
        <Set>RspCod=EFE999</Set>
        <Set>RspMsg=银电系统已在停工状态</Set>
        <Return/>
      </If>
    </Process>
  </Function>


  <Function name="GetWDMC" desc="获取网点名称">
    <DynSentence name="QryPubInf">
      <Sentence>
        select nodnam WDMC from pubnodinf where nodno='%s'
      </Sentence>
      <Fields>NodNo|</Fields>
    </DynSentence>
    <Process>
      <Exec func="PUB:ReadRecord">
        <Arg name="SqlCmd" value="QryPubInf"/>
      </Exec>
    </Process>
  </Function>




</Package>
